_yaml_path: exp/test_2row.yaml
config_hash: e21fd897e7cc14d9
data:
  dataset_path: data/CORAL/coral-expert-curated-medical-oncology-reports-to-advance-language-model-inference-1.0/coral/unannotated/data/breastca_unannotated.csv
  row_range:
  - 0
  - 2
experiment:
  name: default
  seed: 42
extraction:
  max_retries: 3
  verify: true
generation:
  assessment_plan:
    do_sample: false
    max_new_tokens: 2048
  keypoint:
    do_sample: false
    max_new_tokens: 512
  retry:
    do_sample: true
    max_new_tokens: 2048
    temperature: 0.6
    top_p: 0.9
model:
  cache_dir: /mnt/c/Users/yc/.cache/huggingface
  device_map: auto
  dtype: bfloat16
  name: meta-llama/Llama-3.1-8B-Instruct
prompts:
  extraction: prompts/extraction.yaml
  plan_extraction: prompts/plan_extraction.yaml
prompts_content:
  extraction:
    Goals_of_care: 'TASK: Extract ''What We Discussed / Decided''.

      Respond *only* with a JSON object using this exact schema:

      {

      "goals_of_treatment": "eg, cancer is not curable, but it''s treatable and the
      goal is to extend the duration and maintain the quality of life",

      "response_assessment": "How the cancer is responding to the treatment, not responding
      or responding."

      }

      '
    Reason_for_Visit: 'TASK: Extract ''Reason for Visit''.

      Respond *only* with a JSON object using this exact schema:

      {

      "Patient type": "either New patient or follow up",

      "second opinion": "whether the visit is consultation/second opinion or not",

      "in-person": "either Televisit or in-person. (note, video consult, televisit,
      telehealth are the same thing)",

      "summary": "A brief summary of the reason for visit."

      }

      '
    Treatment_Summary: 'TASK: Extract ''Treatment Summary''.

      Respond *only* with a JSON object using this exact schema:

      {

      "current_meds": "List of current oncologic medications or regimens.",

      "recent_changes": "Any holds, dose reductions, or switches.",

      "supportive_meds": "List of supportive medications."

      }

      '
    What_We_Found: 'TASK: Extract ''What We Found''.

      Respond *only* with a JSON object using this exact schema:

      {

      "Type_of_Cancer": "list the type of cancer",

      "Stage_of_Cancer": "list the stage if it is written in the note",

      "Distant Metastasis": "if there is distant metastasis (met). Yes, to where;
      No, local, not sure, need more evidence such as imaging.",

      "Metastasis": "if there is met, Yes (to where), No, or Not sure",

      "lab_summary": "Summary of key lab results.",

      "findings": "Summary of new findings or disease status."

      }

      '
  plan_extraction:
    Advance_care_planning: "TASK: Extract the 'Advance care planning' from the given\
      \ 'Assessment/Plan' section.\nInclude Advance directives, health-care proxy,\
      \ code status (if appropriate).\nRespond *only* with a JSON object using this\
      \ exact schema:\n{\n    \"Advance care\": \"A summary of any planned Advance\
      \ care.\"\n}\n"
    Genetic_Testing_Plan: "TASK: Extract the 'Genetic Testing Plan' from the given\
      \ 'Assessment/Plan' section.\n\n1. Scope of section:\n- First, find the 'Assessment/Plan'\
      \ section of the note (usually the final section).\n- Only look for plans that\
      \ are clearly about FUTURE genetic or molecular TESTING.\n\n2. What COUNTS as\
      \ 'genetic or molecular testing':\n- Diagnostic, prognostic, or predictive laboratory\
      \ assays, such as:\n  - Tumor genomic sequencing / NGS / panel testing\n  -\
      \ Germline genetic panels (e.g., hereditary cancer panel, BRCA testing)\n  -\
      \ Liquid biopsy / circulating tumor DNA (ctDNA) tests\n  - Specific biomarker\
      \ tests (e.g., PD-L1 testing, MSI testing, EGFR mutation testing)\n  - Any plan\
      \ to \"send\", \"order\", \"check\", or \"obtain\" a genetic, genomic, or molecular\
      \ TEST\n\n3. What MUST be EXCLUDED:\n- DO NOT include any medications, systemic\
      \ therapies, or treatment plans:\n  - Chemotherapy, immunotherapy, targeted\
      \ therapies (e.g., FGFR inhibitor, PARP inhibitor, CDK4/6 inhibitor, TKIs)\n\
      \  - Hormonal therapy, radiation therapy, surgery\n  - Clinical trial options,\
      \ even if the trial involves targeted drugs or inhibitors\n- DO NOT include\
      \ tests that are already completed, historic, or only mentioned in past oncology\
      \ history.\n- DO NOT include imaging (CT, PET, MRI, X-ray, ultrasound) or routine\
      \ labs (CBC, CMP).\n\n4. If there is NO new genetic or molecular test planned\
      \ in the Assessment/Plan:\n- Set the value to a clear negative statement, for\
      \ example:\n  \"No new genetic or molecular tests were planned during this visit.\"\
      \n\n5. Output format:\nRespond *only* with a JSON object using this exact schema:\n\
      {\n    \"genetic_testing_plan\": \"A summary of any future planned genetic or\
      \ molecular tests, or a clear statement that none are planned.\"\n}\n"
    Imaging_Plan: "TASK: Extract the 'Imaging Plan' from the given 'Assessment/Plan'\
      \ section.\nInclude all future imaging like CT, MRI, PET/CT, ultrasound,  DEXA\
      \ scans, including timing and rationale if mentioned.\nDo not include any procedure\
      \ plan, lab plan, or medication plan. Do not include past Imaging.\nRespond\
      \ *only* with a JSON object using this exact schema:\n{\n    \"imaging_plan\"\
      : \"A summary of any planned procedures.\"\n}\n"
    Lab_Plan: "TASK: Extract the 'lab Plan' from the given 'Assessment/Plan' section.\n\
      Include future labs like CBC, CMP, tumor markers, coagulation profile. Specify\
      \ frequency and rationale if mentioned.\nDo not include any procedure plan,\
      \ medication plan, or imagining plan. Do not include past labs.\nRespond *only*\
      \ with a JSON object using this exact schema:\n{\n    \"lab_plan\": \"A summary\
      \ of the future lab plan.\"\n}\n"
    Medication_Plan: "TASK: Extract the 'Medication Plan' from the given 'Assessment/Plan'\
      \ section.\nInclude future medication plans, changes to current meds (start,\
      \ stop, continue), supportive meds, bowel regimen, and any blood transfusion\
      \ plan. Do not include past medications.\nRespond *only* with a JSON object\
      \ using this exact schema:\n{\n    \"medication_plan\": \"A summary of the complete\
      \ medication plan.\"\n}\n"
    Medication_Plan_chatgpt: "TASK: Extract the 'Medication Plan' from the given 'Assessment/Plan'\
      \ section.\nInclude all current and future medication plans for both cancer\
      \ therapy and supportive treatment. Cancer treatment could be one or many in\
      \ chemotherapy, hormonal therapy, bone therapy, radiotherapy (eg. rad onc, xrt).\
      \ Supportive treatment could be one or many in bowel regimen, pain medication,\
      \ psychiatry medication, neuropathy or any blood transfusion plan.\n\nInclude\
      \ whether a medication is being started now (e.g,\"will start\", \"Rx sent\"\
      , \"starting today\" ), plan or discuss in the future after certain condition\
      \ (e.g., \"plan to start after radiation\", \"discussed addition ofâ€¦\"), continue\
      \ or maintained(\"continue\"), stop or change.\n\nInclude an alterative, second-line\
      \ or clinical trials options if dicussed.\nInclude an 'other treatment' section\
      \ for any other medications that only briefly mentioned in the plan section.\n\
      Respond *only* with a JSON object using this exact schema:\n{\n    \"The medication/treatment,\
      \ one of chemotherapy, hormonal therapy, bone therapy, radiotherapy\":\n{\"\
      summary\":\"the summary of this type of medication, including start/stop/cotinue\
      \ if applicable\",\n\"Short term side_effects_discussed\": \"short term Side\
      \ effects of this particular medications.\",\n\"Long term side_effects_discussed\"\
      : \"long term Side effects of this particular medications..\"}\n}\n"
    Procedure_Plan: "TASK: Extract the 'Procedure Plan' from the given 'Assessment/Plan'\
      \ section.\nInclude future procedures including surgery, radiation therapy,\
      \ or interventional procedures such as biopsy, lumbar puncture, or Chemo Port\
      \ Insertion. Do not include past procedures.\nDo not include imaging plan, lab\
      \ plan, or medication plan.\nRespond *only* with a JSON object using this exact\
      \ schema:\n{\n    \"procedure_plan\": \"A summary of any planned procedures.\"\
      \n}\n"
    Referral: 'TASK: Extract ''Referral'' from the given ''Assessment/Plan'' section.

      do not mistake the doctor''s signature at the end of the note as a referral.

      Respond *only* with a JSON object using this exact schema:

      {

      "Nutrition": "any nutrition referrals such as diet optimization, appetite, weight
      maintenance",

      "Genetics": "eg, germline testing, family counseling",

      "Specialty": "eg, Palliative care (symptom or pain management, goals of care),
      Radiation oncology, surgical oncology, Psychology, psychiatry for coping and
      mood support",

      "Others": "Physical or occupational therapy, Social work, financial counseling",

      "follow up": "follow up mentioned in the provided text. f/up[, f/p and fup all
      mean follow up."

      }

      '
    Therapy_plan: "TASK: Extract the 'therapy Plan' from the given 'Assessment/Plan'\
      \ section.\nInclude chemotherapy, radiotherapy, hormonal therapy, and bone-therapy\
      \ plans. Include future plans, changes to current therapy (start, stop, continue).\
      \ Do not include past therapies.\nRespond *only* with a JSON object using this\
      \ exact schema:\n{\n    \"therapy_plan\": \"A summary of the complete therapy\
      \ plan.\"\n}\n"
    follow_up_next_visit: "TASK: Extract the 'follow up/next visit' from the given\
      \ 'Assessment/Plan' section.\n\nRespond *only* with a JSON object using this\
      \ exact schema:\n{\n    \"Next clinic visit\": \"(in-person or telehealth):\
      \ timing and purpose\"\n}\n"
    radiotherapy_plan: 'TASK: Extract the ''radiotherapy Plan'' from the given ''Assessment/Plan''
      section.

      For radiotherapy, include ANY statement that indicates

      it is being considered, recommended, or may be used, even if no explicit

      start/continue/plan keywords are present.

      '
